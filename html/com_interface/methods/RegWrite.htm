<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Method RegWrite
</title>
  <meta http-equiv="Content-Type" content="text/html; charset=shift-jis">
  <link href="../../css/default.css" rel="stylesheet" type="text/css">
</head>

<body>
<h1>Method Reference (COM)</h1>
<font size="+1">RegWrite
</font>
<hr size="2">
<p>レジストリ内にキー、値を作成します。<br></p>

<p class="codeheader">
RegWrite "keyname" [,"valuename", "type", value]<br>
</p>
<p>&amp;nbsp;</p>

<p><b>パラメータ</b></p>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr>
    <td width="15%">keyname</td>
    <td width="85%">書き込むレジストリキー。他のパラメータが指定されなかった場合、このキーが作成されるだけです。</td>
  </tr>
  <tr>
   <td>valuename</td>
   <td>書き込む値名</td>
  </tr>
  <tr>
   <td>type</td>
   <td>書き込むキーの型："REG_SZ"、"REG_MULTI_SZ"、"REG_EXPAND_SZ"、"REG_DWORD"、"REG_BINARY"。 </td>
  </tr>
  <tr>
   <td>value</td>
   <td>書き込む値</td>
  </tr>
</table>
<p>&amp;nbsp;</p>

<p><b>返し値</b></p>
<table width="100%">
  <tr>
    <td width="10%">成功:</td>
    <td width="90%">1を返します。</td>
  </tr>
  <tr>
    <td>失敗:</td>
    <td>レジストリキー、値の書き込みエラーの場合、0を返します。</td>
  </tr>
</table>
<p>&amp;nbsp;</p>

<p><b>注意</b></p>
レジストリキーは"HKEY_LOCAL_MACHINE" ("HKLM")、"HKEY_USERS" ("HKU")、"HKEY_CURRENT_USER" ("HKCU") 、"HKEY_CLASSES_ROOT" ("HKCR")、"HKEY_CURRENT_CONFIG" ("HKCC")のいずれかで始まらなければなりません。<br>
<br>
AutoItはREG_BINARY、REG_SZ、REG_MULTI_SZ、REG_EXPAND_SZ、REG_DWORDのレジストリキー型をサポートしています。<br>
<br>
<b>(Default)</b>値にアクセスするためには、<b>""</b>(空文字列)をvaluenameに使用してください。<br>
<br>
REG_BINARYキーを書き込む場合、16進数文字の文字列を使ってください。例えば01,a9,ff,77のREG_BINARY値は文字列"01A9FF77"を使うことで書き込むことができます。<br>
<br>
REG_MULTI_SZキーを書き込む場合はそれぞれの値を@LFで区切ってください。空部分文字列を付け加えたい場合を除いて、値の最後には@LFをつけないでください(例を参照)。<br>
<br>
keynameに"\\computername\keyname"形式を使用することでリモートのレジストリにアクセスすることが可能です。この機能を使用するためにはNT/2000/XP/2003の正しいアクセス権限を持っていなければなりません。9x系のOSを使用している場合、リモートのPCにはリモートレジストリサービスが最初にインストールされている必要があります（Microsoft Knowledge Base Article - 141460を参照）。<br>
<br>
<p>&amp;nbsp;</p>

<p><b>関連</b></p>
<a href="../../html\com_interface\methods\RegDelete.htm">RegDelete</a>, <a href="RegRead.htm">RegRead</a>
<p>&amp;nbsp;</p>

<p><b>例</b></p>
<p class="codebox">
Set oAutoIt = WScript.CreateObject("AutoItX3.Control")<br>
<br>
' REG_SZ値を1つ書き込み<br>
oAutoIt.RegWrite "HKEY_LOCAL_MACHINE\SOFTWARE", "TestKey", "REG_SZ", "Hello this is a test"<br>
<br>
<br>
' "line1"、"line2"というREG_MULTI_SZ値を書き込み<br>
oAutoIt.RegWrite "HKEY_LOCAL_MACHINE\SOFTWARE", "TestKey", "REG_MULTI_SZ", "line1" &amp; @LF &amp; "line2"<br>
<br>
' 間違ったREG_MULTI_SZの使用方法 <br>
oAutoIt.RegWrite "HKEY_LOCAL_MACHINE\SOFTWARE", "TestKey", "REG_MULTI_SZ", "line1" &amp; @LF &amp; "line2" &amp; @LF<br>
oAutoIt.RegWrite "HKEY_LOCAL_MACHINE\SOFTWARE", "TestKey", "REG_MULTI_SZ", "line1" &amp; @LF &amp; @LF &amp; "line2" &amp; @LF<br>
<br>
<p>&amp;nbsp;</p>

</body>
</html>
