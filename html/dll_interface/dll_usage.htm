<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<head>
  <title>Using the COM Interface</title>
  <meta http-equiv="Content-Type" content="text/html; charset=shift-jis">
  <link href="../css/default.css" rel="stylesheet" type="text/css">
</head>
<body>
<h1>Using the DLL Interface </h1>
<p>外部DLL内の関数を呼べる言語であればどの言語からでもAutoItXを標準DLLとして使用することができます。</p>
<p>&nbsp;</p>
<p>DLLを(C/C++から)利用できるように以下のファイルが提供されています：</p>
<p><strong>AutoIt3.h</strong> - エクスポートされる関数とパラメータが記載されたC言語のヘッダーファイル</p>
<p><strong>AutoItX3.lib</strong> - Microsoftフォーマットのインポートライブラリー</p>
<p>&nbsp;</p>
<p>他の言語のサポートを容易にするファイルについてはユーザーからの投稿があればAutoItXと共に提供されるようになるでしょう(VB、Delphiなどのものが必要とされています)。</p>
<p>&nbsp;</p>
<p>各関数の呼び出しはCOMバージョンと変わらず、COMのドキュメントとAutoIt3.hファイルから必要な情報は容易に理解できるので各関数のドキュメントは提供されていません。COMバージョンとの唯一の違いはテキストを<strong>受け取る</strong>関数だけです − AU3_WinGetTitleのようなこれらの関数には <strong>nBufSize</strong>と呼ばれる追加のパラメータが存在します − このパラメータには利用できる出力テキストバッファのサイズを設定しなければなりません。</p>
<p>例： AU3_WinGetTextのプロトタイプ宣言： </p>
<p class="code"> void AU3_WinGetTitle(const char *szTitle, const char *szText, char *szRetText, int nBufSize);</p>
<p>&nbsp;</p>
<p>返されるバッファはszRetTextで、(C言語での)利用方法のサンプルは次のようになります：</p>
<p class="code">char szMyTitle[200];</p>
<p class="code">AU3_WinGetTitle(&quot;Untitled - Notepad&quot;, &quot;&quot;, szMyTitle, 200);</p>
<p class="code">MessageBox(NULL, szMyTitle, &quot;Returned window title was:&quot;, MB_OK); </p>
<p>&nbsp;</p>
<p>nBufSizeは単純に返されるテキストでのバッファオーバーランを防ぐために使われます。</p>
<p>&nbsp; </p>
</body>
</html>
